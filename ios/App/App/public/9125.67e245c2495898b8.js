"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9125],{9125:(Y,f,d)=>{d.r(f),d.d(f,{Tab1PageModule:()=>w});var r=d(7896),g=d(177),p=d(4341),T=d(1307),b=d(4964),m=d(467),e=d(3953),k=d(8079),P=d(2872),y=d(2431);let j=(()=>{var n;class s{constructor(){}}return(n=s).\u0275fac=function(i){return new(i||n)},n.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),s})(),C=(()=>{var n;class s{constructor(){}getCurrentPosition(){var i=this;return(0,m.A)(function*(){return new Promise((t,a)=>{navigator.geolocation.getCurrentPosition(function(){var l=(0,m.A)(function*(c){const _=c.coords.latitude,u=c.coords.longitude,h=yield i.reverseGeocode(_,u);t({latitude:_,longitude:u,address:h})});return function(c){return l.apply(this,arguments)}}(),l=>{a(l)},{enableHighAccuracy:!0})})})()}reverseGeocode(i,t){return(0,m.A)(function*(){const a=`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${i}&lon=${t}`,l=yield fetch(a);if(!l.ok)throw new Error("Failed to fetch address");return(yield l.json()).display_name||"Adresse non trouv\xe9e"})()}}return(n=s).\u0275fac=function(i){return new(i||n)},n.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),s})();const F=["paymentModal"],I=()=>[0,1,2,3,4,5,6,7,8,9];function M(n,s){1&n&&(e.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),e.nrm(3,"ion-skeleton-text",12),e.k0s(),e.j41(4,"ion-card-subtitle"),e.nrm(5,"ion-skeleton-text",13),e.k0s()(),e.j41(6,"ion-card-content"),e.nrm(7,"ion-skeleton-text",13),e.k0s()())}function S(n,s){1&n&&(e.j41(0,"div")(1,"ion-list"),e.DNE(2,M,8,0,"ion-card",11),e.k0s()()),2&n&&(e.R7$(2),e.Y8G("ngForOf",e.lJ4(1,I)))}function E(n,s){1&n&&(e.j41(0,"div")(1,"ion-item")(2,"ion-label",14),e.EFF(3,"Aucun test trouv\xe9"),e.k0s()()())}function R(n,s){1&n&&(e.j41(0,"div")(1,"ion-item")(2,"ion-label",14),e.EFF(3,"Aucun pack trouv\xe9"),e.k0s()()())}function G(n,s){if(1&n){const o=e.RV6();e.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title",15),e.bIt("click",function(){const t=e.eBV(o).$implicit,a=e.XpG(2);return e.Njj(a.goToDetails(t.id))}),e.EFF(3),e.k0s(),e.j41(4,"ion-card-subtitle",16),e.EFF(5),e.k0s(),e.j41(6,"ion-icon",17),e.bIt("click",function(){const t=e.eBV(o).$implicit,a=e.XpG(2);return e.Njj(a.addToCart(t))}),e.k0s()(),e.j41(7,"ion-card-content",18),e.EFF(8),e.k0s()()}if(2&n){const o=s.$implicit;e.R7$(3),e.JRh(o.name),e.R7$(2),e.SpI("",o.time," days"),e.R7$(3),e.SpI(" ",o.price," FCFA ")}}function $(n,s){if(1&n&&(e.j41(0,"div")(1,"ion-list"),e.DNE(2,G,9,3,"ion-card",11),e.k0s()()),2&n){const o=e.XpG();e.R7$(2),e.Y8G("ngForOf",o.filteredItems)}}function D(n,s){if(1&n){const o=e.RV6();e.j41(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title",15),e.bIt("click",function(){const t=e.eBV(o).$implicit,a=e.XpG(2);return e.Njj(a.goToDetailsPack(t.id))}),e.EFF(3),e.k0s(),e.j41(4,"ion-icon",17),e.bIt("click",function(){const t=e.eBV(o).$implicit,a=e.XpG(2);return e.Njj(a.addToCart(t))}),e.k0s()()()}if(2&n){const o=s.$implicit;e.R7$(3),e.JRh(o.name)}}function O(n,s){if(1&n&&(e.j41(0,"div")(1,"ion-list"),e.DNE(2,D,5,1,"ion-card",11),e.k0s()()),2&n){const o=e.XpG();e.R7$(2),e.Y8G("ngForOf",o.filteredPacks)}}function L(n,s){if(1&n&&(e.j41(0,"ion-badge",14),e.EFF(1),e.k0s()),2&n){const o=e.XpG();e.R7$(),e.JRh(o.cartItems.length)}}function N(n,s){if(1&n){const o=e.RV6();e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.k0s(),e.j41(3,"div",24)(4,"ion-button",25),e.bIt("click",function(){const t=e.eBV(o).$implicit,a=e.XpG(2);return e.Njj(a.updateQuantity(t,t.quantity-1))}),e.EFF(5,"-"),e.k0s(),e.j41(6,"ion-input",26),e.mxI("ngModelChange",function(t){const a=e.eBV(o).$implicit;return e.DH7(a.quantity,t)||(a.quantity=t),e.Njj(t)}),e.bIt("ionChange",function(){const t=e.eBV(o).$implicit,a=e.XpG(2);return e.Njj(a.updateQuantity(t,t.quantity))}),e.k0s(),e.j41(7,"ion-button",27),e.bIt("click",function(){const t=e.eBV(o).$implicit,a=e.XpG(2);return e.Njj(a.updateQuantity(t,t.quantity+1))}),e.EFF(8,"+"),e.k0s()(),e.j41(9,"ion-label"),e.EFF(10),e.k0s(),e.j41(11,"ion-icon",28),e.bIt("click",function(){const t=e.eBV(o).$implicit,a=e.XpG(2);return e.Njj(a.removeFromCart(t))}),e.k0s()()}if(2&n){const o=s.$implicit;e.R7$(2),e.JRh(o.name),e.R7$(2),e.Y8G("disabled",1===o.quantity),e.R7$(2),e.R50("ngModel",o.quantity),e.R7$(4),e.SpI("",o.price*o.quantity," FCFA")}}function x(n,s){if(1&n&&(e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2,"Position:"),e.k0s(),e.j41(3,"ion-label"),e.EFF(4),e.nrm(5,"br"),e.EFF(6),e.k0s()()),2&n){const o=e.XpG(2);e.R7$(4),e.JRh(o.deliveryLocation.address),e.R7$(2),e.Lme(" La:",o.deliveryLocation.latitude," ,Lon: ",o.deliveryLocation.longitude,"")}}function V(n,s){if(1&n){const o=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Panier"),e.k0s(),e.j41(4,"ion-buttons",19)(5,"ion-button",20),e.bIt("click",function(){e.eBV(o),e.XpG();const t=e.sdS(24);return e.Njj(t.dismiss())}),e.EFF(6,"Fermer"),e.k0s()()()(),e.j41(7,"ion-content")(8,"ion-list"),e.DNE(9,N,12,4,"ion-item",11),e.k0s(),e.j41(10,"ion-item")(11,"ion-label"),e.EFF(12,"Total:"),e.k0s(),e.j41(13,"ion-label"),e.EFF(14),e.k0s()(),e.j41(15,"ion-label",21),e.bIt("click",function(){e.eBV(o);const t=e.XpG();return e.Njj(t.getCurrentLocation())}),e.EFF(16," Autour de moi "),e.nrm(17,"ion-icon",22),e.k0s(),e.DNE(18,x,7,3,"ion-item",5),e.j41(19,"ion-button",23),e.bIt("click",function(){e.eBV(o);const t=e.XpG();return e.Njj(t.pay())}),e.EFF(20,"Payer"),e.k0s()()}if(2&n){const o=e.XpG();e.R7$(9),e.Y8G("ngForOf",o.cartItems),e.R7$(5),e.SpI("",o.calculateTotal()," FCFA"),e.R7$(4),e.Y8G("ngIf",o.deliveryLocation)}}const X=[{path:"",component:(()=>{var n;class s{constructor(i,t,a,l,c,_,u){var h=this;this.firestore=i,this.actionSheetCtrl=t,this.navCtrl=a,this.cartService=l,this.toastController=c,this.paymentService=_,this.locationService=u,this.presentingElement=null,this.cartItems=[],this.filteredItems=[],this.filteredPacks=[],this.searchTerm="",this.selectedSegment="simple",this.isDataLoaded=!1,this.canDismiss=(0,m.A)(function*(){const v=yield h.actionSheetCtrl.create({header:"Voulez-vous annuler ?",buttons:[{text:"Oui",role:"confirm"},{text:"Non",role:"cancel"}]});v.present();const{role:A}=yield v.onWillDismiss();return"confirm"===A}),this.loadItems(),this.loadPacks()}ngOnInit(){this.presentingElement=document.querySelector(".ion-page"),this.cartService.cartItems$.subscribe(i=>{this.cartItems=i})}loadItems(){this.items=this.firestore.collection("tests").valueChanges(),this.items.subscribe(i=>{this.filteredItems=i,this.isDataLoaded=!0})}loadPacks(){this.packs=this.firestore.collection("packs").valueChanges(),this.packs.subscribe(i=>{this.filteredPacks=i,this.isDataLoaded=!0})}onSegmentChange(){this.selectedSegment="pack"===this.selectedSegment?"pack":"simple",this.searchTests()}searchTests(){""===this.searchTerm.trim()?"simple"===this.selectedSegment?this.loadItems():this.loadPacks():"simple"===this.selectedSegment?this.filteredItems=this.filteredItems.filter(i=>i.name.toLowerCase().includes(this.searchTerm.toLowerCase())):this.filteredPacks=this.filteredPacks.filter(i=>i.name.toLowerCase().includes(this.searchTerm.toLowerCase()))}presentToast(i){var t=this;return(0,m.A)(function*(){(yield t.toastController.create({message:i,duration:3e3,position:"bottom"})).present()})()}addToCart(i){this.cartService.addToCart(i),this.presentToast("Article ajout\xe9 au panier")}updateQuantity(i,t){t<1||this.cartService.updateQuantity(i,t)}removeFromCart(i){this.cartService.removeFromCart(i)}calculateTotal(){return this.cartService.calculateTotal()}getCurrentLocation(){var i=this;return(0,m.A)(function*(){try{i.deliveryLocation=yield i.locationService.getCurrentPosition(),i.presentToast("Position r\xe9cup\xe9r\xe9e avec succ\xe8s")}catch{i.presentToast("Erreur lors de la r\xe9cup\xe9ration de la position")}})()}pay(){this.saveOrder()}saveOrder(){if(0===this.cartItems.length||0===this.calculateTotal())return void this.presentToast("Veuillez ajouter des articles au panier avant de passer une commande.");if(!this.deliveryLocation||!this.deliveryLocation.address)return void this.presentToast("Veuillez renseigner l'adresse de livraison avant de passer une commande.");const i={items:this.cartItems,totalCost:this.calculateTotal(),date:(new Date).toISOString(),status:"pending",deliveryLocation:this.deliveryLocation};this.firestore.collection("orders").add(i).then(()=>{this.presentToast("Commande enregistr\xe9e avec succ\xe8s"),this.cartService.clearCart(),this.deliveryLocation=void 0,this.modal&&this.modal.dismiss()}).catch(t=>{this.presentToast("Erreur lors de l'enregistrement de la commande"),console.error("Erreur lors de l'enregistrement de la commande:",t)})}openModal(){this.modal&&this.modal.present()}updateCart(){this.cartItems=[...this.cartItems]}goToDetails(i){this.navCtrl.navigateForward(`/details/${i}`)}goToDetailsPack(i){this.navCtrl.navigateForward(`/details-pack/${i}`)}}return(n=s).\u0275fac=function(i){return new(i||n)(e.rXU(k.Qe),e.rXU(r.GD),e.rXU(P.q9),e.rXU(y.m),e.rXU(r.K_),e.rXU(j),e.rXU(C))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-tab1"]],viewQuery:function(i,t){if(1&i&&(e.GBs(r.Sb,5),e.GBs(F,5)),2&i){let a;e.mGM(a=e.lsd())&&(t.modal=a.first),e.mGM(a=e.lsd())&&(t.paymentModal=a.first)}},decls:26,vars:10,consts:[["modal",""],[3,"ngModelChange","ionInput","ngModel"],[3,"ngModelChange","ionChange","ngModel"],["value","simple"],["value","pack"],[4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed"],["id","open-modal",3,"click"],["name","medkit-outline"],["color","danger",4,"ngIf"],["trigger","open-modal",3,"canDismiss","presentingElement"],[4,"ngFor","ngForOf"],["animated","",2,"width","50%"],["animated","",2,"width","30%"],["color","danger"],["color","primary",3,"click"],[1,"time"],["color","primary","name","add-circle",1,"add",3,"click"],["color","primary"],["slot","end"],[3,"click"],["expand","block","shape","round","color","primary","text-center","",1,"close",3,"click"],["name","location-outline"],["expand","block","shape","round",3,"click"],[1,"quantity-controls"],["fill","clear","size","large",3,"click","disabled"],["type","number","min","1",3,"ngModelChange","ionChange","ngModel"],["fill","clear","size","large",3,"click"],["name","close-circle",3,"click"]],template:function(i,t){if(1&i){const a=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Health Test"),e.k0s()(),e.j41(4,"ion-toolbar")(5,"ion-searchbar",1),e.mxI("ngModelChange",function(c){return e.eBV(a),e.DH7(t.searchTerm,c)||(t.searchTerm=c),e.Njj(c)}),e.bIt("ionInput",function(){return e.eBV(a),e.Njj(t.searchTests())}),e.k0s()()(),e.j41(6,"ion-content")(7,"ion-segment",2),e.mxI("ngModelChange",function(c){return e.eBV(a),e.DH7(t.selectedSegment,c)||(t.selectedSegment=c),e.Njj(c)}),e.bIt("ionChange",function(){return e.eBV(a),e.Njj(t.onSegmentChange())}),e.j41(8,"ion-segment-button",3)(9,"ion-label"),e.EFF(10,"Simple"),e.k0s()(),e.j41(11,"ion-segment-button",4)(12,"ion-label"),e.EFF(13,"Pack"),e.k0s()()(),e.DNE(14,S,3,2,"div",5)(15,E,4,0,"div",5)(16,R,4,0,"div",5)(17,$,3,1,"div",5)(18,O,3,1,"div",5),e.j41(19,"ion-fab",6)(20,"ion-fab-button",7),e.bIt("click",function(){return e.eBV(a),e.Njj(t.openModal())}),e.nrm(21,"ion-icon",8),e.DNE(22,L,2,1,"ion-badge",9),e.k0s()(),e.j41(23,"ion-modal",10,0),e.DNE(25,V,21,3,"ng-template"),e.k0s()()}2&i&&(e.R7$(5),e.R50("ngModel",t.searchTerm),e.R7$(2),e.R50("ngModel",t.selectedSegment),e.R7$(7),e.Y8G("ngIf",!t.isDataLoaded),e.R7$(),e.Y8G("ngIf","simple"===t.selectedSegment&&t.isDataLoaded&&!t.filteredItems.length),e.R7$(),e.Y8G("ngIf","pack"===t.selectedSegment&&t.isDataLoaded&&!t.filteredPacks.length),e.R7$(),e.Y8G("ngIf","simple"===t.selectedSegment&&t.filteredItems.length),e.R7$(),e.Y8G("ngIf","pack"===t.selectedSegment&&t.filteredPacks.length),e.R7$(4),e.Y8G("ngIf",null==t.cartItems?null:t.cartItems.length),e.R7$(),e.Y8G("canDismiss",t.canDismiss)("presentingElement",t.presentingElement))},dependencies:[r.In,r.Jm,r.QW,r.b_,r.I9,r.ME,r.HW,r.tN,r.W9,r.Q8,r.YW,r.eU,r.iq,r.$w,r.uz,r.he,r.nf,r.S1,r.Gp,r.eP,r.ds,r.BC,r.ai,r.Sb,r.su,r.Je,r.Gw,r.T6,g.Sq,g.bT,p.BC,p.vS],styles:['@charset "UTF-8";ion-header[_ngcontent-%COMP%]{--background: var(--ion-color-primary);--color: var(--ion-color-primary-contrast)}ion-header[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-family:var(--ion-font-family);font-size:1.5rem;font-weight:700;text-align:center}ion-toolbar[_ngcontent-%COMP%]{--background: var(--ion-color-primary);--color: var(--ion-color-primary-contrast)}ion-segment-button[_ngcontent-%COMP%]{--background: var(--ion-color-primary-shade);--color: var(--ion-color-primary-contrast);font-family:var(--ion-font-family)}ion-card[_ngcontent-%COMP%]{border-radius:15px}ion-card[_ngcontent-%COMP%]{margin:8px 0}ion-card-title[_ngcontent-%COMP%]{font-size:1.2rem}ion-button[_ngcontent-%COMP%]{--border-radius: var(--ion-border-radius)}ion-fab-button[_ngcontent-%COMP%]{--background: var(--ion-color-primary)}ion-modal[_ngcontent-%COMP%]   ion-header[_ngcontent-%COMP%]{--background: var(--ion-color-primary);--color: var(--ion-color-primary-contrast)}ion-modal[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{font-family:var(--ion-font-family);font-size:1.5rem;font-weight:700;text-align:center}ion-label.close[_ngcontent-%COMP%]{font-size:21px;font-weight:700;text-align:center}.centered-label[_ngcontent-%COMP%]{justify-content:center;text-align:center}ion-label.close[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;cursor:pointer;margin-top:15px;margin-bottom:15px}ion-label.close[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-left:8px}.add[_ngcontent-%COMP%]{margin-left:auto;padding:auto;width:30px;height:30px}']}),s})()}];let B=(()=>{var n;class s{}return(n=s).\u0275fac=function(i){return new(i||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[b.iI.forChild(X),b.iI]}),s})(),w=(()=>{var n;class s{}return(n=s).\u0275fac=function(i){return new(i||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[r.bv,g.MD,p.YN,T.S,B]}),s})()}}]);